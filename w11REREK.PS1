# =====================================================================
# Bypass-Win11-Checks_REREK_once.ps1
# Auteur : REREK (https://bessahlirezki.com)
# - Cr√©e/MAJ les cl√©s de registre LabConfig (Bypass TPM, SecureBoot, RAM)
# =====================================================================

# ------------------------
# Fonctions utilitaires
# ------------------------
function Show-RerekBanner {
    $banner = @"
RRRR   EEEEE  RRRR   EEEEE  K   K
R   R  E      R   R  E      K  K 
RRRR   EEEE   RRRR   EEEE   KKK  
R  R   E      R  R   E      K  K 
R   R  EEEEE  R   R  EEEEE  K   K
"@
    Write-Host ""
    Write-Host $banner -ForegroundColor Cyan
    Write-Host "üîß Script de pr√©paration Windows 11 (bypass des v√©rifications) ‚Äî REREK" -ForegroundColor Gray
    Write-Host ""
    Start-Sleep -Seconds 2   # <-- n'affiche que 2 secondes
    Clear-Host
}

function Assert-Admin {
    if (-not ([Security.Principal.WindowsPrincipal]
        [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole(
        [Security.Principal.WindowsBuiltInRole]::Administrator)) {
        Write-Host "‚ùå Ce script doit √™tre ex√©cut√© en tant qu'Administrateur." -ForegroundColor Red
        exit 1
    }
}

# ------------------------
# Affiche la banni√®re 2s
# ------------------------
Show-RerekBanner

# ------------------------
# V√©rification d'√©l√©vation
# ------------------------
Assert-Admin

# -----------------------------------
# Cl√©s de registre LabConfig (HKLM)
# -----------------------------------
Write-Host " je prends des selfie avec Skye mon fils ( üß© Cr√©ation/MAJ de HKLM:\SYSTEM\Setup\LabConfig ... )" -ForegroundColor Cyan
try {
    New-Item -Path "HKLM:\SYSTEM\Setup\LabConfig" -Force | Out-Null

    New-ItemProperty -Path "HKLM:\SYSTEM\Setup\LabConfig" -Name "BypassTPMCheck"        -Value 1 -PropertyType DWord -Force | Out-Null
    New-ItemProperty -Path "HKLM:\SYSTEM\Setup\LabConfig" -Name "BypassSecureBootCheck"  -Value 1 -PropertyType DWord -Force | Out-Null
    New-ItemProperty -Path "HKLM:\SYSTEM\Setup\LabConfig" -Name "BypassRAMCheck"         -Value 1 -PropertyType DWord -Force | Out-Null

    Write-Host "‚úÖ Bypass appliqu√© : TPM, SecureBoot et RAM." -ForegroundColor Green
}
catch {
    Write-Host "‚ö†Ô∏è Erreur lors de la modification du registre : $($_.Exception.Message)" -ForegroundColor Yellow
    exit 1
}

Write-Host ""
Write-Host "‚û°Ô∏è Vous pouvez maintenant lancer l'installation de Windows 11 si n√©cessaire." -ForegroundColor Gray
